from winreg import *
import os
def disable_usb_ports():
    keyVal1 = r'SYSTEM\CurrentControlSet\Services\USBSTOR'
    try:
        key1 = OpenKey(HKEY_LOCAL_MACHINE, keyVal1, 0, KEY_ALL_ACCESS)
    except:
        key1 = CreateKey(HKEY_LOCAL_MACHINE, keyVal1)
    SetValueEx(key1, "start", 0, REG_DWORD, 3)
    CloseKey(key1)

    keyVal2 = r'SYSTEM\CurrentControlSet\Services\cdrom'
    try:
        key2 = OpenKey(HKEY_LOCAL_MACHINE, keyVal2, 0, KEY_ALL_ACCESS)
    except:
        key2 = CreateKey(HKEY_LOCAL_MACHINE, keyVal2)
        SetValueEx(key2, "start", 0, REG_DWORD, 1)
        CloseKey(key2)

    keyVal3 = r'SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Capture'
    try:
        key3 = OpenKey(HKEY_LOCAL_MACHINE, keyVal3, 0, KEY_ALL_ACCESS)
    except:
        key3 = CreateKey(HKEY_LOCAL_MACHINE, keyVal3)
        SetValueEx(key3, "start", 0, REG_DWORD, 0)
        CloseKey(key3)

    keyVal4 = r'SOFTWARE\Microsoft\Windows Media Foundation\Platform\EnableFrameServerMode'
    try:
        key4 = OpenKey(HKEY_LOCAL_MACHINE, keyVal4, 0, KEY_ALL_ACCESS)
    except:
        key4 = CreateKey(HKEY_LOCAL_MACHINE, keyVal4)
        SetValueEx(key4, "start", 0, REG_DWORD, 0)
        CloseKey(key4)

    os.system('reboot now')


disable_usb_ports()